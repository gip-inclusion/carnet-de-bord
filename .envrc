# Use the nix context if installed
if command -v nix-shell &> /dev/null ; then
  # Install nix-direnv (for use flake) if necessary
	if ! has nix_direnv_version || ! nix_direnv_version 2.3.0; then
		source_url "https://raw.githubusercontent.com/nix-community/nix-direnv/2.3.0/direnvrc" "sha256-Dmd+j63L84wuzgyjITIfSxSD57Tx7v51DMxVZOsiUD8="
	fi
	use flake

	# Add asdf tools to path
	ASDF_CONF=$(dirname $(dirname $(which asdf)))/share/asdf-vm
	if command -v fish_config &> /dev/null ; then
		source $ASDF_CONF/asdf.fish
	else
		source $ASDF_CONF/asdf.sh
	fi
fi



# Source the poetry env to enable import resolution in vim and vscode
poetry_env=$(cd backend && poetry env list --full-path | cut -d " " -f 1)
source $poetry_env/bin/activate
